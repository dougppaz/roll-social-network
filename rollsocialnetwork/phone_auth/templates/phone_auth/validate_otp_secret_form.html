{% extends 'common_base.html' %}

{% load i18n %}

{% block subtitle %}{% translate 'OTP Secret' %}{% endblock %}

{% block content %}
<div class="header-saver"></div>
<section>
    <h2>{% translate 'your OTP key' %}</h2>
    <p>{% translate 'register this key in your 2FA authentication apps such as Google Authenticator or Authy and authenticate next time with the generated OTP code.' %}</p>
    {% with uri=otp_secret.uri %}
    <div class="colls align-center">
        <div class="coll">
            <div class="qr-code" data-qr-code="{{ uri }}">
                <div class="loading"><i class="fa-solid fa-spinner fa-spin-pulse"></i></div>
            </div>
        </div>
        <div>
            <p class="margin-2rem-0"><a href="{{ uri }}" class="button">{% translate 'Click to register on your 2FA app' %}</a></p>
            <form>
                <div>
                    <label for="key">{% translate 'OTP key:' %}</label>
                    <div class="helptext">{% translate 'click to copy to clipboard' %}</div>
                    <input
                        id="key"
                        class="input"
                        value="{{ otp_secret.value }}"
                        readonly
                        data-copy2clipboard />
                </div>
            </form>
        </div>
    </div>
    {% endwith %}
</section>
<section>
    <h2 class="discreet">{% translate 'validate and activate' %}</h2>
    <p>{% translate 'enable time-based OTP authentication after validating below with the code generated by your 2FA app.' %}</p>
    <form method="post">
        {% csrf_token %}
        {{ form }}
        <div>
            <button type="submit">{% translate 'validate' %}</button>
            <span><a href="{% url 'timeline' %}" class="small">{% translate 'validate later' %}</a></span>
        </div>
    </form>
</div>
{% endblock %}
